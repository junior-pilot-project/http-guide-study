# 2.0 URL과 리소스
목표

- URL 문법, 여러 URL 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지.
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서.
- URL의 인코딩과 문자 규칙.
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴.
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능하게 해주는 URN(Uniform Resource Name)을 포함한 URL의 미래.

## 2.1인터넷의 리소스 탐색 
- URL을 통해서 사전에 규약화 된 다양한 프로토콜을 통해서 통신하게된다. 
	- http, ftp, smtp .... 

## 2.1.1 암흑기
- 과거에 여러 단계의 과정을 수없이 거쳐야 하는 시대가 있었는데 url 문법과 프로토콜을 규약으로 확정지었기 때문에 요즘에는 URL 주소 하나로 모든것이 해결되고있다.
- 과거
	```
	1. ~도메인에 접속, 
	2. 아이디 비밀번호 요청하여 사용자 인증, 3. 대상파일 다운로드 해봐!, 
	```
- 현재
	```
	ftp://[domain명]/파일위치/파일명 다운로드 해봐!
	```

## 2.2 URL문법
- 스킴, 용자이름, 비밀번호, 호스트, 포트, 경로, 파라미터, 질의, 프래그먼트 등이 있다. 
```
<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
```

## 2.2.1 스킴 : 사용할 프로토콜
- 주어진 리소스에 접근하려 하는지 알려주는 중요한 정보이다.(프로토콜)
- 스킴은 대소문자를 가리지 않는다. 
- 예 : http, https, ftp 등등...

## 2.2.3 호스트와 포트 
- 어플리케이션이 있는 위치를 찾기위한 "호스트정보" 와 호스트 서버내의 접근 번호를 명시.

## 2.2.3 사용자 이름과 비밀번호
```
http://joe:joespasswd@www.joes-hardware.com/sales_info.txt
```
- 위과 같은 형식은 보안상 매우 취약하여 현재는 거의 사용되지 않는다. 
- 최신 브라우저에서는 기본적으로 차단되거나 경고 표시가 된다. 
- 현재는 HTTP 헤더를 사용한 인증 방식 적용하기도 한다. 

> 요약: 과거에는 HTTP 기본 인증을 위해 URL에 ID와 비밀번호를 포함하는 방식을 사용했지만, 보안 문제로 인해 현재는 사용되지 않으며, 대신 HTTP 요청 헤더를 활용한 방식이 표준이 되었다.

> 보통 2000년대 까지 사용했다. (이러한 형태의 패킷 전송은 wireshark 같은 패킷 사이트에서 열람이 가능하다.)

## 2.2.4 경로
```
http://www.joes-hardware. com:80/seasonal/index-fall.html
```
- 유닉스 파일시스템의 파일경로와 유사. 
- 웹 서버(Apache, Nginx 등)가 파일 시스템 경로를 직접 매핑했다.
- 현재는 대부분의 웹 프레임워크가 경로를 재정의하는 방식으로 운영됩니다.

> but! 웹 프레임워크에서는 가상 경로를 설정할 수 있어 실제 파일과 대응되지 않을 수도 있다.

```
Spring Boot (Java)
@GetMapping("/seasonal")
public String seasonalPage() {
	return "seasonal.html";
}
```

## 2.2.5 파라미터 
```
http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true
```
- URL의 파라미터 컴포넌트는, 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다. 이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 '' 문자로 구분하여 URL에 기술한다.
- 리소스 자체에 대한 정보 제공

## 2.2.6 질의 문자열
- 경로부 뒤에 ? 물음표 뒤에 나타난 문자열을 질의 문자열이라고 한다. 
- 예시 : 
	```
	http://www.joes-hardware.com/hammers;sale=false/index.html?port=3000&user=testuser
	```
 > 2개 이상의 질의 문자열을 전송할경우에는 & 를 이용하여 연달아 작성한다. 

#### 파라미터와 질의 문자열의 차이
- ; (세미콜론) - 파라미터
	- 경로(Path) 뒤에 붙음
	- 리소스 자체에 대한 정보 제공
	- RESTful API, 파일 속성
	- 브라우저는 무시 (서버에서 해석)


- ? (물음표) - 질의(Query)
	- 경로 뒤, 파라미터보다 후순위
	- 서버에 요청할 데이터 전달, 
	- 검색, 필터링, 페이지 이동
	- 서버와 브라우저 모두 해석

## 2.2.7 프래그먼트
```
http://www.joes-hardware.com/tools.html#drills
```
- 이 예에서 drills라는 프래그먼트는 죠의 컴퓨터 가게 웹 서버에 위치한 /tools.html 웹페이지의 일부를 가리킨다. 그 부분을 'drills'라고 기술하였다.

- html 소스에서 drills 라는 섹션을 보여준다. 
- 서버에서는 프래그먼트(#) 은 해석하지 않는다.


예시> 
```
    <h2 id="drills">전동 드릴 모음</h2>
    <p>이 페이지에는 다양한 전동 드릴이 소개됩니다.</p>
```
> 위와같이 html에서 "drills" 위치를 보여주게 된다. 

---
## 2.3.1절대 URL과 상대 URL

- 상대 URL vs 절대 URL
	- 절대 URL: 리소스에 접근하는 데 필요한 모든 정보를 포함한 URL.
		- 예) http://www.joes-hardware.com/hammers.html
    - 상대 URL: 일부 정보(스킴, 호스트 등)를 생략하고, **기저 URL(Base URL)**을 기준으로 해석되는 URL.
    	- 예) ./hammers.html

	- 상대 URL의 특징
		- URL을 짧게 표기할 수 있어 HTML 작성이 간편해짐.
		- 문서의 위치를 이동해도 상대 URL을 사용하면 자동으로 경로가 재해석됨.
		- 서버의 다른 콘텐츠를 미러링할 때 유용.

- 기저 URL과 상대 URL 변환 요약
	- 기저 URL(Base URL)의 역할
	- 기저URL : 상대 URL을 절대 URL로 변환하는 기준이 되는 URL.
		- 기저 URL을 찾는 방법:
			1.	HTML 문서에서 명시적으로 제공
				- <base> 태그 사용 가능
				- 예)
					```
					<base href="https://www.example.com/docs/">
					```
			2.	현재 문서의 URL을 자동으로 사용
				- 상대 URL이 포함된 문서의 URL을 기준으로 해석
			3.	문서에 기저 URL이 없는 경우
				- 절대 URL만으로만 이루어져있다는 뜻.
				- 절대 URL을 사용해야 하며, 상대 URL을 사용할 수 없음.
				- 상대 URL이 깨진 URL이 될 수도 있음.

	- 상대 URL을 절대 URL로 변환하는 과정
		```
			접속주소 : https://www.example.com/docs?type=txt
			상   대 : ./userlist.txt
		```
		- 1단계: 기저 URL(Base URL)을 찾는다.
			```
				https://www.example.com/docs
			```
		- 2단계: 상대 URL을 컴포넌트 단위로 분해한다.
			| 구성 요소            | 값                           |
			|--------------------|----------------------------|
			| **스킴 (Scheme)**   | `https://`|
			| **호스트 (Host)**   | `www.example.com`|
			| **경로 (Path)**     | `/docs/`|
			| **쿼리 문자열 (Query String)** | `?type=txt`   |
		- 3단계: 기저 URL과 상대 URL을 조합하여 절대 URL을 생성한다.
			```
			https://www.example.com/docs/userlist.txt
			```
		- 4단계: RFC 1808 및 RFC 2396에 정의된 알고리즘을 따라 변환을 완료한다.
			```
			```

> 브라우저는 상대 URL을 기저 URL을 기준으로 변환하여 절대 URL을 생성함.

> 기저 URL이 명확하지 않으면 상대 URL이 제대로 해석되지 않을 수 있음.

> URL을 변환하는 과정은 RFC 1808 및 RFC 2396의 표준 규칙을 따름.


## 2.3.2 URL 확장
### URL 확장(자동 완성 기능)
- 브라우저는 사용자가 URL을 입력할 때 자동 확장 기능을 제공하여, 전체 URL을 입력하지 않아도 빠르게 접속할 수 있도록 도와준다.
	1. 호스트 명 확장
		- 브라우저가 입력된 텍스트를 기반으로 도메인을 자동으로 완성.
			- 예) 사용자가 yahoo를 입력하면 → www.yahoo.com으로 자동 확장됨.
		- 일부 브라우저는 yahoo와 관련된 여러 URL을 제안할 수도 있음.
		- 주의: 프락시(Proxy) 서버를 사용할 경우, 자동 확장 기능이 예상과 다르게 작동할 수 있음.

	2. 히스토리 확장
		- 브라우저가 이전에 방문했던 URL을 저장하고, 사용자가 입력한 내용을 바탕으로 추천함.
			- 예) 사용자가 http://www.joes-를 입력하면 → 브라우저가 http://www.joes-hardware.com을 자동 완성.
		- 입력 시간을 줄여주고, 자주 방문하는 사이트를 빠르게 찾을 수 있도록 도움.
		- 프락시 사용 시 자동 확장 기능이 다르게 동작할 수도 있음.

	## 2.4 안전하지 않은 문자
	- 기존 전송방식에는 안전한 알파벳 문자열만 전송하도록 허락했는데, 이후 다양한 문자열과 문자 이외의 문자도 포함시키고자 하였다. 
	- 그래서 이스케이프 기능을 추가하여 안전하지 않은 문자열을 안전한 문자로 인코딩 하기에 이르렀다. 

	### 2.4.1 URL 문자집합
	- url 으로 영문으로만 표기하던 상황에서 비영어권 사람들이 쓰기위해서는 사용할 수가 없는 상황이 일어나게 되는데 그 문제점을 해결하기위해서 이스케이프 문자(Percent-Encoding) 가 도입된다.
	- 인코딩 변환표에서 참조된 문자열 앞에 % 를 추가함으로 한글도 주소에 포함시킬 수 있게 된다.
	- 그렇게 됨으로 영어권 이외에 타 문화권에서도 url 을 자국어로 표현 할 수 있게 되었다. 
	### 2.4.2 인코딩 체계
	- '~' , '빈 문자열', '%' 와같은 문자열은 URL에 사용되면 의미전달에 영향을 줄 수있기에 안전하지 문자열에 속하게 된다. 안전한 문자열으로 전달하기위해 아스키 코드 앞에 %를 추가하여 url을작성해 줌으로서 의미전달을 가능하게 해줬다. 
	### 2.4.3 문자 제한
	무조건 이스케이프 문자열을 포함시켜줘야 하는 문자를 참조하여야 한다. 
	(42페이지 표2-3 참조)

## 2.5 스킴의 바다
여러 스킴에 따라서 url에 표현되는 방식이 모두 다르다. 44페이지의 내용을 참조하여 알아두도록 하자. 

## 2.6 미래
- 지속 통합 자원 지시자(Persistent uniform resource locators, PURL)을 사용하면 URL로 URN의 기능을 제공할 수 있다. PURL은 리소스의 실제 URL 목록을 관리하 고 추적하는 리소스 위치 중개 서버를 두고, 해당 리소스를 우회적으로 제공한다.
클라이언트는 위치 할당자에게 리소스를 가져올 수 있는 영구적인 URL을 요청 할 수 있으며, 영구적인 URL은 클라이언트를 리소스의 실제 URL로 연결해준다(그 림 2-6). PURL에 대한 더 자세한 정보는 http://purl.oclc.org를 참고하자.
### 2.6.1 지금이 아니면 언제?
- URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이다. 표준화는 매우 중 요한 작업인 만큼 느리게 진행될 때도 있다. URN을 지원하려면 많은 변화가 필요 할 것이다. 표준을 제정하는 것에서부터 여러 HTTP 애플리케이션을 수정하기 위 한 벤더들과의 합의도 필요하다. 그러한 변화를 만들어내기 위해서는 엄청난 작업 량이 필요하고, 유감스럽게도(혹은 다행스럽게도) URN으로 전환하기 위한 모든 것
